-- Gerado por Oracle SQL Developer Data Modeler 3.1.4.710
--   em:        2014-06-09 15:33:20 BRT
--   site:      Oracle Database 11g
--   tipo:      Oracle Database 11g



CREATE TABLE TB_CAT_HAB 
    ( 
     ID_CAT NUMBER (15)  NOT NULL , 
     CATEGORIA VARCHAR2 (15 BYTE) 
    ) 
;



ALTER TABLE TB_CAT_HAB 
    ADD CONSTRAINT TB_CAT_HAB_PK PRIMARY KEY ( ID_CAT ) ;



CREATE TABLE TB_CLIENTE 
    ( 
     ID_CLIENTE NUMBER (15)  NOT NULL , 
     NOME VARCHAR2 (60 BYTE)  NOT NULL , 
     CPF_CNPJ VARCHAR2 (20 BYTE)  NOT NULL , 
     TELEFONE VARCHAR2 (15 BYTE)  NOT NULL , 
     EMAIL VARCHAR2 (60 BYTE) , 
     ENDERECO VARCHAR2 (100 BYTE) 
    ) 
;



ALTER TABLE TB_CLIENTE 
    ADD CONSTRAINT TB_CLIENTE_PK PRIMARY KEY ( ID_CLIENTE ) ;



CREATE TABLE TB_DIARIA 
    ( 
     ID_DIARIA NUMBER (15)  NOT NULL , 
     HR_CHEGADA TIMESTAMP , 
     HR_SAIDA TIMESTAMP , 
     TOTAL_HR_EXT_DIA VARCHAR2 (15) , 
     FK_FRANQUIA_HRS NUMBER (15)  NOT NULL , 
     FK_ORDEM_DE_SERVICO NUMBER (15)  NOT NULL , 
     KM_CHEGADA NUMBER (15) , 
     KM_SAIDA NUMBER (15) , 
     TOTAL_KM_RODADO NUMBER (15) , 
     FK_FRANQUIA_KM NUMBER  NOT NULL 
    ) 
;



ALTER TABLE TB_DIARIA 
    ADD CONSTRAINT TB_DIARIA_PK PRIMARY KEY ( ID_DIARIA ) ;



CREATE TABLE TB_FRANQUIA_HRS 
    ( 
     ID_FRANQUIA NUMBER (15)  NOT NULL , 
     HR_FRANQUIA VARCHAR2 (15) 
    ) 
;



ALTER TABLE TB_FRANQUIA_HRS 
    ADD CONSTRAINT TB_FRANQUIA_PK PRIMARY KEY ( ID_FRANQUIA ) ;



CREATE TABLE TB_FRANQUIA_KM 
    ( 
     ID_FRANQUIA_KM NUMBER  NOT NULL , 
     KM VARCHAR2 (15) 
    ) 
;



ALTER TABLE TB_FRANQUIA_KM 
    ADD CONSTRAINT TB_FRANQUIA_KM_PK PRIMARY KEY ( ID_FRANQUIA_KM ) ;



CREATE TABLE TB_FUNCIONARIO 
    ( 
     ID_FUNCIONARIO NUMBER (15)  NOT NULL , 
     NOME VARCHAR2 (60)  NOT NULL , 
     CPF VARCHAR2 (15 BYTE)  NOT NULL , 
     TELEFONE VARCHAR2 (15 BYTE) , 
     EMAIL VARCHAR2 (80 BYTE)  NOT NULL , 
     ENDERECO VARCHAR2 (100 BYTE) , 
     SENHA VARCHAR2 (200 BYTE)  NOT NULL , 
     TB_PERFIL_ID_PERFIL NUMBER  NOT NULL 
    ) 
;



ALTER TABLE TB_FUNCIONARIO 
    ADD CONSTRAINT TB_FUNCIONARIO_PK PRIMARY KEY ( ID_FUNCIONARIO ) ;



CREATE TABLE TB_MARCA 
    ( 
     ID_MARCA NUMBER (15)  NOT NULL , 
     MARCA VARCHAR2 (20 BYTE)  NOT NULL 
    ) 
;



ALTER TABLE TB_MARCA 
    ADD CONSTRAINT TB_MARCA_PK PRIMARY KEY ( ID_MARCA ) ;



CREATE TABLE TB_MODELO 
    ( 
     ID_MODELO NUMBER (15)  NOT NULL , 
     MODELO VARCHAR2 (60 BYTE)  NOT NULL , 
     FK_MARCA NUMBER (15)  NOT NULL 
    ) 
;



ALTER TABLE TB_MODELO 
    ADD CONSTRAINT TB_MODELO_PK PRIMARY KEY ( ID_MODELO ) ;



CREATE TABLE TB_MOTORISTA 
    ( 
     ID_MOTORISTA NUMBER (15)  NOT NULL , 
     NOME VARCHAR2 (60 BYTE)  NOT NULL , 
     CPF VARCHAR2 (15 BYTE)  NOT NULL , 
     TELEFONE VARCHAR2 (15 BYTE)  NOT NULL , 
     EMAIL VARCHAR2 (60 BYTE) , 
     ENDERECO VARCHAR2 (80) , 
     FK_CAT_HAB NUMBER (15)  NOT NULL 
    ) 
;



ALTER TABLE TB_MOTORISTA 
    ADD CONSTRAINT TB_MOTORISTA_PK PRIMARY KEY ( ID_MOTORISTA ) ;



CREATE TABLE TB_ORDEM_DE_SERVICO 
    ( 
     ID_OS NUMBER (15)  NOT NULL , 
     DATA_DA_OS DATE , 
     TOTAL_HRS_EXTRA VARCHAR2 (15) , 
     TOTAL_KM_EXTRA NUMBER (15) , 
     OBSERVACAO VARCHAR2 (500 BYTE) , 
     FK_VEICULO NUMBER (15)  NOT NULL , 
     FK_CLIENTE NUMBER (15)  NOT NULL , 
     FK_MOTORISTA NUMBER (15)  NOT NULL , 
     USUARIO_SERV VARCHAR2 (60 BYTE) , 
     USUARIO_TEL VARCHAR2 (15) , 
     FK_FUNCIONARIO NUMBER (15) 
    ) 
;



ALTER TABLE TB_ORDEM_DE_SERVICO 
    ADD CONSTRAINT TB_ORDEM_DE_SERVICO_PK PRIMARY KEY ( ID_OS ) ;



CREATE TABLE TB_PERFIL 
    ( 
     ID_PERFIL NUMBER  NOT NULL , 
     PERFIL VARCHAR2 (15 BYTE) 
    ) 
;



ALTER TABLE TB_PERFIL 
    ADD CONSTRAINT TB_PERFIL_PK PRIMARY KEY ( ID_PERFIL ) ;



CREATE TABLE TB_VEICULO 
    ( 
     ID_VEICULO NUMBER (15)  NOT NULL , 
     ANO VARCHAR2 (15 BYTE)  NOT NULL , 
     PLACA VARCHAR2 (15 BYTE)  NOT NULL , 
     PROPRIETARIO VARCHAR2 (60 BYTE)  NOT NULL , 
     TELEFONE VARCHAR2 (15 BYTE)  NOT NULL , 
     FK_MODELO NUMBER (15)  NOT NULL 
    ) 
;



ALTER TABLE TB_VEICULO 
    ADD CONSTRAINT TB_VEICULO_PK PRIMARY KEY ( ID_VEICULO ) ;




ALTER TABLE TB_MOTORISTA 
    ADD CONSTRAINT FK_CAT_HAB FOREIGN KEY 
    ( 
     FK_CAT_HAB
    ) 
    REFERENCES TB_CAT_HAB 
    ( 
     ID_CAT
    ) 
;


ALTER TABLE TB_ORDEM_DE_SERVICO 
    ADD CONSTRAINT FK_CLIENTE FOREIGN KEY 
    ( 
     FK_CLIENTE
    ) 
    REFERENCES TB_CLIENTE 
    ( 
     ID_CLIENTE
    ) 
;


ALTER TABLE TB_DIARIA 
    ADD CONSTRAINT FK_FRANQUIA FOREIGN KEY 
    ( 
     FK_FRANQUIA_HRS
    ) 
    REFERENCES TB_FRANQUIA_HRS 
    ( 
     ID_FRANQUIA
    ) 
;


ALTER TABLE TB_ORDEM_DE_SERVICO 
    ADD CONSTRAINT FK_FUNCIONARIO FOREIGN KEY 
    ( 
     FK_FUNCIONARIO
    ) 
    REFERENCES TB_FUNCIONARIO 
    ( 
     ID_FUNCIONARIO
    ) 
;


ALTER TABLE TB_MODELO 
    ADD CONSTRAINT FK_MARCA FOREIGN KEY 
    ( 
     FK_MARCA
    ) 
    REFERENCES TB_MARCA 
    ( 
     ID_MARCA
    ) 
;


ALTER TABLE TB_VEICULO 
    ADD CONSTRAINT FK_MODELO FOREIGN KEY 
    ( 
     FK_MODELO
    ) 
    REFERENCES TB_MODELO 
    ( 
     ID_MODELO
    ) 
;


ALTER TABLE TB_ORDEM_DE_SERVICO 
    ADD CONSTRAINT FK_MOTORISTA FOREIGN KEY 
    ( 
     FK_MOTORISTA
    ) 
    REFERENCES TB_MOTORISTA 
    ( 
     ID_MOTORISTA
    ) 
;


ALTER TABLE TB_DIARIA 
    ADD CONSTRAINT FK_ORDEM_DE_SERVICO FOREIGN KEY 
    ( 
     FK_ORDEM_DE_SERVICO
    ) 
    REFERENCES TB_ORDEM_DE_SERVICO 
    ( 
     ID_OS
    ) 
;


ALTER TABLE TB_ORDEM_DE_SERVICO 
    ADD CONSTRAINT FK_VEICULO FOREIGN KEY 
    ( 
     FK_VEICULO
    ) 
    REFERENCES TB_VEICULO 
    ( 
     ID_VEICULO
    ) 
;


ALTER TABLE TB_DIARIA 
    ADD CONSTRAINT TB_DIARIA_TB_FRANQUIA_KM_FK FOREIGN KEY 
    ( 
     FK_FRANQUIA_KM
    ) 
    REFERENCES TB_FRANQUIA_KM 
    ( 
     ID_FRANQUIA_KM
    ) 
;


ALTER TABLE TB_FUNCIONARIO 
    ADD CONSTRAINT TB_FUNCIONARIO_TB_PERFIL_FK FOREIGN KEY 
    ( 
     TB_PERFIL_ID_PERFIL
    ) 
    REFERENCES TB_PERFIL 
    ( 
     ID_PERFIL
    ) 
;

CREATE OR REPLACE TRIGGER FKNTO_TB_ORDEM_DE_SERVICO 
BEFORE UPDATE OF FK_FUNCIONARIO 
ON TB_ORDEM_DE_SERVICO 
FOR EACH ROW 
BEGIN 
 IF :old.FK_FUNCIONARIO IS NOT NULL THEN 
  raise_application_error(-20225,'Non Transferable FK constraint FK_FUNCIONARIO on table TB_ORDEM_DE_SERVICO is violated'); 
 END IF; 
END; 
/

CREATE SEQUENCE SEQ_TB_CLIENTE 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_CLIENTE 
BEFORE INSERT ON TB_CLIENTE 
FOR EACH ROW 
WHEN (NEW.ID_CLIENTE IS NULL) 
BEGIN 
    SELECT SEQ_TB_CLIENTE.NEXTVAL INTO :NEW.ID_CLIENTE FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_DIARIA 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_DIARIA 
BEFORE INSERT ON TB_DIARIA 
FOR EACH ROW 
WHEN (NEW.ID_DIARIA IS NULL) 
BEGIN 
    SELECT SEQ_TB_DIARIA.NEXTVAL INTO :NEW.ID_DIARIA FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_FUNCIONARIO 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_FUNCIONARIO 
BEFORE INSERT ON TB_FUNCIONARIO 
FOR EACH ROW 
WHEN (NEW.ID_FUNCIONARIO IS NULL) 
BEGIN 
    SELECT SEQ_TB_FUNCIONARIO.NEXTVAL INTO :NEW.ID_FUNCIONARIO FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_MARCA 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_MARCA 
BEFORE INSERT ON TB_MARCA 
FOR EACH ROW 
WHEN (NEW.ID_MARCA IS NULL) 
BEGIN 
    SELECT SEQ_TB_MARCA.NEXTVAL INTO :NEW.ID_MARCA FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_MODELO 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_MODELO 
BEFORE INSERT ON TB_MODELO 
FOR EACH ROW 
WHEN (NEW.ID_MODELO IS NULL) 
BEGIN 
    SELECT SEQ_TB_MODELO.NEXTVAL INTO :NEW.ID_MODELO FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_MOTORISTA 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_MOTORISTA 
BEFORE INSERT ON TB_MOTORISTA 
FOR EACH ROW 
WHEN (NEW.ID_MOTORISTA IS NULL) 
BEGIN 
    SELECT SEQ_TB_MOTORISTA.NEXTVAL INTO :NEW.ID_MOTORISTA FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_OS 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TGR_TB_OS 
BEFORE INSERT ON TB_ORDEM_DE_SERVICO 
FOR EACH ROW 
WHEN (NEW.ID_OS IS NULL) 
BEGIN 
    SELECT SEQ_TB_OS.NEXTVAL INTO :NEW.ID_OS FROM DUAL; 
END;
/

CREATE SEQUENCE SEQ_TB_VEICULO 
    MINVALUE 1 
    MAXVALUE 999999999 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER TRG_TB_VEICULO 
BEFORE INSERT ON TB_VEICULO 
FOR EACH ROW 
WHEN (NEW.ID_VEICULO IS NULL) 
BEGIN 
    SELECT SEQ_TB_VEICULO.NEXTVAL INTO :NEW.ID_VEICULO FROM DUAL; 
END;
/



-- Relatório do Resumo do Oracle SQL Developer Data Modeler: 
-- 
-- CREATE TABLE                            12
-- CREATE INDEX                             0
-- ALTER TABLE                             23
-- CREATE VIEW                              0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           9
-- ALTER TRIGGER                            0
-- CREATE STRUCTURED TYPE                   0
-- CREATE COLLECTION TYPE                   0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          8
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
